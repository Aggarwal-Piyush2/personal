<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Day II | The Final Destination</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@1,400;1,700&family=Montserrat:wght@200;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --gold: #c5a059; --velvet: #1a0505; --diamond: #f0f8ff; }
        
        body, html { 
            margin: 0; padding: 0; background: #000; color: white; 
            font-family: 'Montserrat', sans-serif; height: 1200vh;
            overflow-x: hidden; scroll-behavior: smooth;
            -webkit-tap-highlight-color: transparent;
        }

        /* 1. CINEMATIC OVERLAY */
        #light-flare {
            position: fixed; top: 50%; left: 50%; width: 10vw; height: 10vw;
            background: radial-gradient(circle, rgba(255,255,255,0.8) 0%, transparent 70%);
            transform: translate(-50%, -50%); z-index: 5; opacity: 0; pointer-events: none;
        }

        /* 2. THE 3D BOX SCENE */
        .scene {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            display: flex; justify-content: center; align-items: center;
            perspective: 1500px; z-index: 2;
        }
        .box-wrapper { position: relative; width: 250px; height: 250px; transform-style: preserve-3d; transform: rotateX(-15deg) rotateY(15deg); }
        .lid { position: absolute; bottom: 100px; width: 180px; height: 100px; background: #4a0505; border: 1px solid #2a0000; left: 50%; transform-origin: bottom; transform: translateX(-50%) rotateX(0deg); z-index: 10; }
        .base { position: absolute; bottom: 0; width: 180px; height: 100px; background: #2a0000; border: 1px solid #1a0000; left: 50%; transform: translateX(-50%); box-shadow: 0 20px 50px rgba(0,0,0,0.9); }
        #diamond-ring { position: absolute; bottom: 110px; left: 50%; width: 90px; transform: translateX(-50%) scale(0); opacity: 0; filter: drop-shadow(0 0 20px var(--diamond)); transition: transform 0.1s linear; z-index: 5; }

        /* 3. NARRATIVE */
        .text-slide { position: relative; z-index: 10; height: 250vh; display: flex; align-items: center; justify-content: center; padding: 0 30px; }
        .message { font-family: 'Playfair Display', serif; font-size: 1.8rem; text-align: center; color: var(--gold); font-style: italic; opacity: 0; transform: translateY(30px); transition: 1s all; max-width: 100%; line-height: 1.6; }

        /* 4. THE QUESTION CARD */
        .final-reveal { position: relative; z-index: 100; background: #000; min-height: 100vh; display: flex; align-items: center; justify-content: center; }
        .card { background: #0a0a0a; border: 1px solid var(--gold); padding: 50px 30px; text-align: center; width: 85%; box-shadow: 0 0 100px rgba(197, 160, 89, 0.1); }
        .btn-group { display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 30px; position: relative; width: 100%; }
        
        button { padding: 18px 0; width: 100%; max-width: 250px; font-family: 'Montserrat'; text-transform: uppercase; letter-spacing: 2px; cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275); font-size: 1rem; }
        .btn-yes { background: var(--gold); border: none; color: black; font-weight: 600; z-index: 101; }
        .btn-no { background: transparent; border: 1px solid #444; color: #444; z-index: 100; }

        /* Success Overlay */
        #success-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #000; z-index: 7000; display: none;
            justify-content: center; align-items: center;
            flex-direction: column; text-align: center; overflow-y: auto;
        }
        .celebration-img { width: 80%; max-width: 300px; border: 2px solid var(--gold); margin: 10px; border-radius: 10px; }

        /* TIME LOCK & JIGSAW OVERLAY */
        #time-lock-overlay, #puzzle-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000; z-index: 5000; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
        #puzzle-board { display: grid; grid-template-columns: repeat(3, 80px); grid-template-rows: repeat(3, 80px); gap: 2px; border: 2px solid var(--gold); margin: 20px 0; }
        .puzzle-piece { width: 80px; height: 80px; background-size: 240px 240px; cursor: pointer; border: 1px solid rgba(255,255,255,0.1); }
        .music-control { position: fixed; top: 20px; right: 20px; z-index: 6000; background: rgba(0,0,0,0.5); border: 1px solid var(--gold); color: var(--gold); padding: 5px 10px; font-size: 10px; border-radius: 15px; }
    </style>
</head>
<body>
    <audio id="bg-music" loop><source src="Mohabbat.mp3" type="audio/mpeg"></audio>
    <button class="music-control" onclick="toggleMusic()">üéµ MUSIC</button>

    <div id="time-lock-overlay">
        <h2 style="font-family:'Playfair Display'; color:var(--gold);">Day II</h2>
        <p id="timer-text" style="font-size: 0.8rem; letter-spacing: 2px; color: #888;">SYNCING TIME...</p>
        <div id="entry-button-area"></div>
    </div>

    <div id="puzzle-overlay" style="display:none;">
        <h2 style="font-family:'Playfair Display'; color:var(--gold); font-size: 1.5rem;">Piece together a memory...</h2>
        <div id="puzzle-board"></div>
        <p style="font-size: 0.6rem; color: #666;">SWAP PIECES TO FINISH</p>
    </div>

    <div id="success-overlay">
        <h1 style="font-family: 'Playfair Display'; font-size: 2.5rem; color: var(--gold); margin-bottom: 5px;">YES! ‚ù§Ô∏è</h1>
        <p style="margin-bottom: 20px; font-size: 0.9rem; letter-spacing: 2px;">I LOVE YOU FOREVER</p>
        
        <img src="day2.jpeg" class="celebration-img" alt="Our Picture">
        
        <img src="hug.gif" class="celebration-img" style="width: 200px;" alt="Kissing GIF">
        
        <button onclick="location.reload()" style="margin-top: 30px; background: none; border: 1px solid #333; color: #555; width: auto; padding: 10px 20px; font-size: 0.6rem;">RELIVE THE MOMENT</button>
    </div>

    <canvas id="particles"></canvas>
    <div id="light-flare"></div>

    <div class="scene">
        <div class="box-wrapper" id="box">
            <div class="lid" id="lid-hinge"></div>
            <img id="diamond-ring" src="diamond-ring.png" alt="Diamond Ring">
            <div class="base"></div>
        </div>
    </div>

    <div class="text-slide"><div class="message">Yesterday, we crossed 14,838.83 kilometers...</div></div>
    <div class="text-slide"><div class="message">But my heart always stayed in one place.</div></div>
    <div class="text-slide"><div class="message">With you.</div></div>
    <div class="text-slide"><div class="message">So today, I want to settle the distance forever.</div></div>

    <div class="final-reveal">
        <div class="card">
            <h1 style="font-family: 'Playfair Display'; font-size: 2.2rem; color: var(--gold); margin-bottom: 10px;">The Question</h1>
            <p style="color: #888; letter-spacing: 2px; font-size: 0.8rem;">Will you be my forever destination?</p>
            <div class="btn-group">
                <button class="btn-yes" id="yesBtn" onclick="celebrate()">YES</button>
                <button class="btn-no" id="noBtn" onclick="handleNo()">NO</button>
            </div>
        </div>
    </div>

    <script>
        // --- CONFIGURATION ---
        const UNLOCK_DATE = "2026-01-08T00:00:00"; // Feb 8th Sydney Time
        const PUZZLE_IMG = "us2.jpeg";

        const audio = document.getElementById('bg-music');
        function toggleMusic() { audio.paused ? audio.play() : audio.pause(); }

        // --- TIME LOCK (SYDNEY TIME) ---
        const timerInterval = setInterval(() => {
            const now = new Date();
            const sydTime = new Date(now.toLocaleString("en-US", {timeZone: "Australia/Sydney"}));
            const diff = new Date(UNLOCK_DATE) - sydTime;

            if (diff <= 0) {
                clearInterval(timerInterval);
                document.getElementById('timer-text').style.display = 'none';
                document.getElementById('entry-button-area').innerHTML = `<button onclick="startExperience()" style="background:var(--gold); color:black; border:none; padding:15px 30px; letter-spacing:2px; font-weight:600; cursor:pointer; margin-top:20px;">ENTER VAULT</button>`;
            } else {
                const h = Math.floor(diff / 3600000);
                const m = Math.floor((diff % 3600000) / 60000);
                const s = Math.floor((diff % 60000) / 1000);
                document.getElementById('timer-text').innerHTML = `LOCKED UNTIL FEB 8<br>${h}h ${m}m ${s}s`;
            }
        }, 1000);

        function startExperience() {
            audio.play().catch(e => console.log("Music play pending click"));
            document.getElementById('time-lock-overlay').style.display = 'none';
            document.getElementById('puzzle-overlay').style.display = 'flex';
            initPuzzle();
        }

        // --- JIGSAW LOGIC ---
        let pieces = [0, 1, 2, 3, 4, 5, 6, 7, 8], shuffled = [...pieces].sort(() => Math.random() - 0.5), selected = null;
        function initPuzzle() {
            const board = document.getElementById('puzzle-board');
            board.innerHTML = "";
            shuffled.forEach((val, idx) => {
                const div = document.createElement('div');
                div.className = "puzzle-piece";
                div.style.backgroundImage = `url(${PUZZLE_IMG})`;
                div.style.backgroundPosition = `${-(val % 3) * 80}px ${-Math.floor(val / 3) * 80}px`;
                div.onclick = () => {
                    if (selected === null) { selected = idx; div.style.border = "1px solid gold"; }
                    else {
                        [shuffled[selected], shuffled[idx]] = [shuffled[idx], shuffled[selected]];
                        selected = null; initPuzzle();
                        if (shuffled.every((v, i) => v === pieces[i])) {
                            setTimeout(() => { document.getElementById('puzzle-overlay').style.display = 'none'; }, 500);
                        }
                    }
                };
                board.appendChild(div);
            });
        }

        // --- SCROLL ANIMATION ---
        window.addEventListener('scroll', () => {
            const scrollTotal = document.body.offsetHeight - window.innerHeight;
            const scroll = window.scrollY / scrollTotal;
            const lid = document.getElementById('lid-hinge'), ring = document.getElementById('diamond-ring'), flare = document.getElementById('light-flare');
            
            if (scroll > 0.4 && scroll < 0.8) {
                const p = (scroll - 0.4) / 0.3;
                lid.style.transform = `translateX(-50%) rotateX(${-p * 115}deg)`;
                ring.style.opacity = p;
                ring.style.transform = `translateX(-50%) translateY(${-p * 120}px) scale(${p * 1.5}) rotate(${scroll * 400}deg)`;
                flare.style.opacity = p * 0.5;
                flare.style.width = (p * 80) + "vw"; flare.style.height = (p * 80) + "vw";
            }

            document.querySelectorAll('.message').forEach((m) => {
                const rect = m.parentElement.getBoundingClientRect();
                if (rect.top < window.innerHeight * 0.7 && rect.bottom > 0) { m.style.opacity = 1; m.style.transform = "translateY(0)"; }
                else { m.style.opacity = 0; }
            });
        });

        // --- THE "NO" BUTTON PRANK ---
        let noCount = 0;
        function handleNo() {
            noCount++;
            const noBtn = document.getElementById('noBtn'), yesBtn = document.getElementById('yesBtn');
            const x = Math.random() * (window.innerWidth - 150) - (window.innerWidth/2 - 75);
            const y = Math.random() * (window.innerHeight - 150) - (window.innerHeight/2 - 75);
            noBtn.style.position = 'fixed'; noBtn.style.left = '50%'; noBtn.style.top = '50%';
            noBtn.style.transform = `translate(${x}px, ${y}px) scale(${Math.max(0.5, 1 - noCount*0.1)})`;
            yesBtn.style.transform = `scale(${1 + noCount * 0.15})`;
            if(noCount === 1) noBtn.innerHTML = "Are you sure?";
            if(noCount === 3) noBtn.innerHTML = "Wait... why?";
            if(noCount > 5) noBtn.innerHTML = "Nice try! üòâ";
        }

        function celebrate() {
            document.getElementById('success-overlay').style.display = 'flex';
        }

        // --- PARTICLES ---
        const canvas = document.getElementById('particles'), ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        const pts = [];
        for(let i=0; i<100; i++) pts.push({ x: Math.random()*canvas.width, y: Math.random()*canvas.height, s: Math.random()*2, o: Math.random() });
        function draw() {
            ctx.clearRect(0,0,canvas.width, canvas.height);
            pts.forEach(p => {
                ctx.fillStyle = `rgba(240, 248, 255, ${p.o})`;
                ctx.beginPath(); ctx.arc(p.x, p.y, p.s, 0, Math.PI*2); ctx.fill();
                p.y -= 0.3; if(p.y < 0) p.y = canvas.height;
            });
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>