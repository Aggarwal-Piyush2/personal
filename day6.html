<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Day VI | The Sanctuary</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;1,400&family=Montserrat:wght@200;400;600&display=swap" rel="stylesheet">
    
    <style>
        :root { --bg: #020202; --accent: #d1d1d1; --rose: #ff4d6d; }
        
        body, html { 
            margin: 0; padding: 0; background: var(--bg); color: var(--accent); 
            font-family: 'Montserrat', sans-serif; overflow-x: hidden;
            transition: background 1s ease; scroll-behavior: smooth;
        }

        #particles-js { position: fixed; width: 100%; height: 100%; z-index: 1; pointer-events: none; }

        /* FOGGY MIRROR SECTION */
        .reveal-container {
            position: relative; width: 320px; height: 200px; margin: 50px auto;
            border: 1px solid rgba(255,255,255,0.1); overflow: hidden;
        }
        #fog-canvas { position: absolute; top: 0; left: 0; z-index: 10; touch-action: none; cursor: crosshair; }
        .hidden-msg {
            position: absolute; width: 100%; height: 100%; display: flex;
            align-items: center; justify-content: center; text-align: center;
            font-family: 'Playfair Display'; font-style: italic; font-size: 1.2rem;
            background: #050505; color: white; padding: 20px; box-sizing: border-box;
        }

        /* HEARTBEAT LOGIC */
        .heart-container { margin: 60px 0; text-align: center; }
        #heart-icon {
            font-size: 3rem; color: #4a0404; transition: 0.5s; cursor: pointer;
            display: inline-block; filter: drop-shadow(0 0 10px rgba(0,0,0,0.5));
        }
        .beating { animation: heartbeat 1.2s infinite ease-in-out; color: var(--rose) !important; text-shadow: 0 0 20px var(--rose); }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            15% { transform: scale(1.25); }
            30% { transform: scale(1); }
            45% { transform: scale(1.15); }
            60% { transform: scale(1); }
        }

        /* REST OF STYLES FROM PREVIOUS VERSION */
        .section { padding: 80px 30px; text-align: center; opacity: 0; transform: translateY(30px); transition: 1s; }
        .visible { opacity: 1; transform: translateY(0); }
        .meter-ui { background: rgba(255,255,255,0.03); padding: 30px; backdrop-filter: blur(10px); max-width: 320px; margin: 0 auto; }
        input[type=range] { width: 100%; -webkit-appearance: none; background: rgba(255,255,255,0.1); height: 1px; }
        input[type=range]::-webkit-slider-thumb { -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #fff; }
    </style>
</head>
<body>

    <audio id="bg-music" loop><source src="music.mp3" type="audio/mpeg"></audio>

    <div id="particles-js"></div>

    <div class="section visible" style="height: 100vh; display: flex; align-items: center; justify-content: center; flex-direction: column;">
        <h1 style="font-family:'Playfair Display'; font-weight: 200; letter-spacing: 5px;">THE SANCTUARY</h1>
        <p style="font-size: 0.7rem; letter-spacing: 3px; opacity: 0.5;">WIPE THE GLASS TO SEE MY HEART</p>
        
        <div class="reveal-container">
            <div class="hidden-msg">"Every time I hold you, the rest of the world just... disappears."</div>
            <canvas id="fog-canvas"></canvas>
        </div>
        
        <button onclick="document.getElementById('bg-music').play(); this.style.display='none';" style="background:none; border:1px solid white; color:white; padding:10px 20px; font-family:'Montserrat'; margin-top:20px;">START AUDIO</button>
    </div>

    <div class="section">
        <h2>Adjust the Pressure</h2>
        <div class="meter-ui">
            <input type="range" min="1" max="100" value="20" id="hugSlider">
            <p id="label" style="margin-top:20px; letter-spacing: 3px; font-size: 0.8rem;">GENTLE HOLD</p>
        </div>
    </div>

    <div class="section">
        <div class="heart-container">
            <p style="font-size: 0.6rem; letter-spacing: 4px; opacity: 0.5; margin-bottom: 20px;">TOUCH TO SYNC OUR HEARTS</p>
            <div id="heart-icon" ontouchstart="startHeart()" ontouchend="stopHeart()" onmousedown="startHeart()" onmouseup="stopHeart()">❤️</div>
        </div>
    </div>

    <div class="section" style="padding-bottom: 150px;">
        <p style="font-family:'Playfair Display'; font-style:italic; font-size:1.3rem; line-height: 1.8;">
            "You are my safe place, Diya. No matter how loud the world gets, it's always quiet in your arms."
        </p>
    </div>

    <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
    <script>
        // --- 1. FOGGY MIRROR LOGIC ---
        const canvas = document.getElementById('fog-canvas');
        const ctx = canvas.getContext('2d');
        canvas.width = 320; canvas.height = 200;

        // Create the "Fog"
        ctx.fillStyle = 'rgba(200, 200, 200, 0.95)';
        ctx.fillRect(0, 0, canvas.width, canvas.height);
        // Add some texture to the fog
        for(let i=0; i<100; i++) {
            ctx.fillStyle = `rgba(255,255,255,${Math.random()*0.1})`;
            ctx.beginPath(); ctx.arc(Math.random()*320, Math.random()*200, 20, 0, Math.PI*2); ctx.fill();
        }

        function wipe(e) {
            const rect = canvas.getBoundingClientRect();
            const x = (e.touches ? e.touches[0].clientX : e.clientX) - rect.left;
            const y = (e.touches ? e.touches[0].clientY : e.clientY) - rect.top;
            ctx.globalCompositeOperation = 'destination-out';
            ctx.beginPath(); ctx.arc(x, y, 25, 0, Math.PI*2); ctx.fill();
            // Add a "water drop" effect
            ctx.globalCompositeOperation = 'source-over';
        }
        canvas.addEventListener('mousemove', (e) => { if(e.buttons === 1) wipe(e); });
        canvas.addEventListener('touchmove', (e) => { wipe(e); e.preventDefault(); });

        // --- 2. HEART SYNC LOGIC ---
        const heart = document.getElementById('heart-icon');
        function startHeart() { 
            heart.classList.add('beating'); 
            document.body.style.background = "#1a0202";
            if(window.navigator.vibrate) window.navigator.vibrate([100, 50, 100]); 
        }
        function stopHeart() { 
            heart.classList.remove('beating'); 
            document.body.style.background = "#020202";
        }

        // --- 3. SCROLL REVEAL ---
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => { if (entry.isIntersecting) entry.target.classList.add('visible'); });
        }, { threshold: 0.1 });
        document.querySelectorAll('.section').forEach(s => observer.observe(s));

        // --- 4. HUG SLIDER ---
        document.getElementById('hugSlider').oninput = function() {
            const val = this.value;
            document.getElementById('label').innerText = val > 70 ? "NEVER LETTING GO" : val > 30 ? "TIGHT HOLD" : "GENTLE HOLD";
            document.body.style.background = `radial-gradient(circle, rgb(${val/2},0,0) 0%, black 100%)`;
        };

        // --- 5. PARTICLES ---
        particlesJS("particles-js", {
            "particles": {
                "number": { "value": 30 },
                "opacity": { "value": 0.2 },
                "size": { "value": 2 },
                "move": { "speed": 1, "direction": "top" }
            }
        });
    </script>
</body>
</html>